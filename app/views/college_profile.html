<page main-class="college-profile" footer="false">
    <div class="left-cards">
        <article class="college-card box-shadow ">
            <header>
                <img src="../images/book.jpg" class="college-background">
                <img src="../images/college.png" class="college-logo">
            </header>
            <main>
                <h2 class="name">{{college.initials}}</h2>
                <dl class="details">
                    <div>
                        <dt>{{"colleges.profile.students" | translate}}</dt>
                        <dd>{{college.studentsCount}}</dd>
                    </div>
                    <div>
                        <dt>{{"colleges.profile.grades" | translate}}</dt>
                        <dd>10M</dd>
                    </div>
                </dl>
            </main>
        </article>
        <article class="courses-card box-shadow ">
            <header><h2>{{college.coursesCount}} {{"colleges.profile.courses" | translate}} - <a href="#">{{"colleges.profile.courses.see.all" | translate}}</a></h2></header>
            <hr/>
            <nav>
                <ul class="list">
                    <li ng-repeat="course in courses">
                        <a href="/faculdade/{{college.id}}/cursos/{{course.id}}">{{course.name}}</a>
                    </li>
                </ul>
            </nav>
            <footer class="question">
                <p>{{"colleges.profile.courses.not.decided" | translate}} <a href="#">{{"colleges.profile.courses.not.decided.test" | translate}}</a> ?</p>
            </footer>
        </article>
    </div>
    <div class="center-cards">
        <h1 class="initials">{{college.name}}</h1>

        <section class="informations">
            <input id="posts-tab" type="radio" name="tab-group" class="tab"/>
            <label for="posts-tab" class="tab-label">{{"colleges.profile.timeline.posts" | translate}}</label>

            <input id="comments-tab" type="radio" name="tab-group" class="tab" checked/>
            <label for="comments-tab" class="tab-label">{{"colleges.profile.timeline.comments" | translate}}</label>

            <div class="timeline-card box-shadow">
                <div class="posts">
                    <article ng-repeat="post in timeline.posts" class="post">
                        <img src="../images/college.png" class="college-logo">    
                        <h3 class="college-name">{{college.name}}</h3>
                        <time class="date">{{post.createdAt}}</time>
                        <p class="content">{{post.content}}</p>
                    </article>
                </div>
                <div class="comments">
                    <article ng-if="timeline.conversations.length === 0" class="no-conversations">
                        <h2>{{"colleges.profile.no.comments.yet" | translate}}</h2>
                        <a ng-if="!isLogged" ng-href="{{loginThenCommentsUrl}}">{{"colleges.profile.leave.comment" | translate}}</a>
                        <form angular-validator-submit="leaveComment()" name="leaveCommentForm" novalidate angular-validator method="POST" class="leave-comment" ng-if="isLogged">
                            <p class="btn-comment">{{"colleges.profile.leave.comment" | translate}}</p>
                            <div class="hided-content">
                                <textarea name="comment" ng-model="comment.text" class="comment-field" ng-enter></textarea>
                            </div>
                            <input value="" type="submit" class="btn-comment-confirm">
                        </form>
                    </article>
                    <article ng-repeat="conversation in timeline.conversations" class="conversation">
                        <label for="messages-box-{{conversation.id}}" class="switch-conversation" ng-class="{'non-selectable': conversation.messages.length === 1 }">
                            <input id="messages-box-{{conversation.id}}" type="checkbox" ng-if="conversation.messages.length > 1 || canLoggedUserReply(conversation.studentId)" class="switch">
                            <header ng-class="{'open-conversation': conversation.messages.length > 1 || canLoggedUserReply(conversation.studentId)}">
                                <p class="student-name">{{conversation.studentName}}</p>
                                <time class="sent-date"  am-time-ago="conversation.createdAt | amParse:'DD/MM/YYYY HH:mm:ss'"></time>
                                <div class="question">
                                    <h3>{{conversation.messages[0].content}}</h3>
                                </div>
                            </header>
                            <main>
                                <div ng-repeat="message in conversation.messages" ng-if="$index >= 1" ng-init="isNotSequencial = !isSequentialMessage(conversation.messages, $parent.$index)" class="message {{message.direction}}">
                                    <p ng-if="isFromStudent(message) && isNotSequencial" class="reply-user">{{conversation.studentName}}</p>
                                    <p ng-if="isFromCollege(message) && isNotSequencial" class="reply-user">{{college.initials}}</p>
                                    <div class="content {{isNotSequencial ? 'not-sequential' : ''}}">
                                        <p class="text">{{message.content}}</p>
                                        <time class="sent-date" am-time-ago="message.sentAt | amParse:'DD/MM/YYYY HH:mm:ss'"></time>
                                    </div>
                                </div>
                                <form angular-validator-submit="replyComment(conversation.id, $parent.$index)" name="replyCommentForm" novalidate angular-validator method="POST" ng-if="canLoggedUserReply(conversation.studentId)" class="answer">
                                    <p>Responder</p>
                                    <div class="reply-field">
                                        <textarea name="reply-{{conversation.id}}" ng-model="reply.text" ng-enter></textarea>
                                        <input value="" type="submit" class="btn-reply" >
                                    </div>
                                </form>
                            </main>
                        </label>
                    </article>
                    <form angular-validator-submit="leaveComment()" name="leaveCommentForm" novalidate angular-validator method="POST" class="leave-comment" ng-if="timeline.conversations.length !== 0">
                        <p class="btn-comment">{{"colleges.profile.leave.comment" | translate}}</p>
                        <div class="hided-content">
                            <textarea name="comment" ng-model="comment.text" class="comment-field" ng-enter></textarea>
                        </div>
                        <input value="" type="submit" class="btn-comment-confirm">
                    </form>
                </div>
            </div>
        </section>
        <label class="selectable">
            <article id="campus" class="campus-card box-shadow ">
                <header>
                    <form angular-validator angular-validator-submit="listCampus()" name="listCampusForm" method="GET">
                        <button class="btn-campus">{{"colleges.profile.campus.available" | translate}}</button>
                    </form>
                </header>
                <main>
                    <ol class="campus-list">
                        <li ng-repeat="address in campus">
                            <p class="address">{{address.address}}</p>
                            <p class="state">{{address.state}} -{{address.city}}</p>
                        </li>
                    </ol>
                </main>
            </article>
        </label>
    </div>
    <div class="right-cards">
        <article class="contact-card box-shadow">
            <header><h2>{{"colleges.profile.contact" | translate}}</h2></header>
            <main>
                <div class="contact-row">
                    <p ng-if="college.site !== ''" >Site: </p><a ng-href="http://{{college.site}}">{{college.site}}</a>    
                </div>
                <div class="contact-row">
                    <p ng-if="college.phone !== undefined" class="phone">{{"colleges.profile.contact.phone" | translate}}:</p><p>{{college.phone}}</p>
                </div>
            </main>
        </article>
        <article class="about-card box-shadow ">
            <header><h2>{{"colleges.profile.about" | translate}}</h2></header>
            <nav>
                <div class="link">
                    <a class="about-user" data-target="#assign-student" data-toggle="modal" target="_blank" href ng-click="listCampus()">{{"colleges.profile.about.user" | translate}}</a>
                </div>
                <div class="link"><a class="about-students" href="#">{{"colleges.profile.about.students" | translate}}</a></div>
                <div class="link"><a class="about-courses" href="#">{{"colleges.profile.about.courses" | translate}}</a></div>
                <div class="link"><a class="about-local" href="#">{{"colleges.profile.about.local" | translate}}</a></div>
            </nav>
        </article>
        <article class="footer-card box-shadow ">
            <p>© 2016 QualFacul?</p>
            <nav class="links">
                <a href="#">{{"colleges.profile.footer.about" | translate}}</a>
                <a href="#">{{"colleges.profile.footer.help" | translate}}</a>
                <a href="#">{{"colleges.profile.footer.terms" | translate}}</a>
                <a href="#">{{"colleges.profile.footer.ranking" | translate}}</a>
                <a href="#">{{"colleges.profile.footer.test" | translate}}</a>
                <a href="#">{{"colleges.profile.footer.colleges" | translate}}</a>
            </nav>
        </article>
    </div>
    
    <article class="modal fade assign-student" id="assign-student" tabindex="-1" role="dialog" aria-labelledby="Confirmar matricula" aria-hidden="true">
        <section class="modal-dialog modal-lg">
            <form angular-validator-submit="assignStudent()" name="assignStudentForm" novalidate angular-validator method="POST" class="modal-content">
                <header>
                    <h3>Confirmar matrícula nesta faculdade</h3>
                </header>
                <main>
                    <label class="information text-right">
                        <p>Identificador do aluno</p>
                        <input name="studentRa" class="modal-field" placeholder="Ex: 201694020" ng-model="assign.ra">
                    </label>
                    <label class="information text-right">
                        <p>Campus</p>
                        <div class="addresses">
                            <select name="collegeAddress" 
                                ng-model="assign.collegeAddress" 
                                ng-options="address.address for address in campus"
                                ng-init="assign.collegeAddress=campus[1]"/>
                        </div>
                    </label>
                </main>
                <footer>
                    <button type="button" class="btn-back" data-dismiss="modal">Voltar</button>
                    <input value="Confirmar" type="submit" class="btn-check">
                </footer>
            </form>
        </section>
    </article>

</page>